# 同期バグ修正後 — あなた側でやってほしいこと

データが消える問題を直したあと、**あなたがやる作業**を3つに分けて説明します。

---

## 1. 修正をデプロイする（必須）

**「今のコード」をインターネットに反映して、妻のスマホやあなたのスマホでも直ったアプリが開けるようにする**作業です。

### やり方（GitHub ＋ Vercel でデプロイしている人）

1. **ターミナル**を開く。
2. 家計簿アプリのフォルダに移動する：
   ```bash
   cd "/Users/daisukechiba/Documents/家計簿アプリ"
   ```
3. 次のコマンドを **順に** 打って Enter（1行ずつでOK）：
   ```bash
   git add .
   git commit -m "同期のバグ修正"
   git push -u origin main
   ```
4. **Vercel** が自動で再デプロイする（数十秒〜1分かかることがある）。
5. デプロイが終わったら、**家計簿アプリのURL**（例：`https://kakeibo-app-xxx.vercel.app`）をブラウザで開き直す。  
   → 修正が入ったアプリが表示されればOK。

※ まだ GitHub に上げていない・Vercel でデプロイしていない人は、同じフォルダにある **「デプロイ手順_方法2_GitHubとVercel.md」** の A〜C を最初からやってください。

---

## 2. 消えてしまったデータについて（できれば）

**一度消えたデータは、アプリの操作だけでは元に戻せません。** 次のどれかができるかだけ、確認すると安心です。

| できること | やり方 |
|------------|--------|
| **エクスポートのバックアップがある** | アプリの **設定** タブ → **「エクスポート」** で以前ダウンロードしたファイルがあれば、**「インポート」** でそのファイルを選ぶと、その時点のデータを復元できる。 |
| **Supabase にデータがある** | クラウド同期（Supabase）を使っていた場合、Supabase の管理画面で `household_sync` テーブルを開き、過去の行にデータが残っていないか確認する。残っていれば、中身をコピーして別の方法で復元する必要がある（手作業）。 |
| **どちらもない** | 残念ながら、消えた分は復元できない。このタイミングから、あらためて入力し直す形になる。 |

「バックアップがなくても、これからは消えにくくなる」のが今回の修正です。

---

## 3. 今後の使い方（推奨）

- **クラウド同期をONにしたまま**、**あなた・妻・同じ世帯の人は、同じ Supabase の設定**（同じ「世帯ID」）を使う。
- 修正をデプロイしたあと、**妻のスマホでも、家計簿アプリのURLを開き直す**（ブックマークやホーム画面のアイコンから同じURLで開く）。  
  → そうすると、全員が「直ったアプリ」になり、同期も安定しやすい。
- 心配なときは、**定期的に「設定」の「エクスポート」でデータをダウンロード**しておくと、もしものときに復元しやすい。

---

## まとめ

| 番号 | やること |
|------|----------|
| **1** | `git add .` → `git commit -m "同期のバグ修正"` → `git push` でデプロイする。 |
| **2** | エクスポートのバックアップがあれば「インポート」で復元を試す。 |
| **3** | 全員が同じURLで開き直し、必要ならエクスポートでバックアップを取る。 |

ここまでできれば、「あなた側でやってほしいこと」は完了です。
