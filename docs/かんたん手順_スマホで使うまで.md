# スマホ・PCでオンラインで使う — 中学生でもわかる手順

この家計簿アプリを、**スマホやパソコンから、インターネットで開いて使えるようにする**ための手順です。  
**番号の順にやっていけば大丈夫**です。

---

## ★ AI診断・FP診断について（先に知っておこう）

- **「Gemini APIキーが未設定です」と出る**  
  → デプロイしたあと、**設定タブ**で「Gemini APIキー」を保存すれば使えるようになります。**デプロイしてから対応してOK**です。
- **どこで設定する？**  
  → 使う**それぞれの端末**（自分のスマホ・相手のスマホ・PC）で、1回ずつ「設定」を開いて、Gemini APIキーを入れて「保存」します。キーはその端末のブラウザにだけ保存されます。
- **今の状態のまま作業を進めても、あとからAI診断・FP診断は使える？**  
  → **はい、問題ありません。** 先にデプロイとクラウド同期の設定をやって、落ちついたら「設定」でAPIキーを入れる流れで大丈夫です。

---

## まず知っておくこと（たとえで理解）

| ことば | 意味（たとえ） |
|--------|----------------|
| **デプロイ** | いまは「あなたのパソコンの中」だけにあるアプリを、**インターネット上の「お店」に置く**こと。そうすると、住所（URL）を知っている人が、スマホやパソコンから開けるようになる。 |
| **URL（ユーアールエル）** | インターネット上の**住所**。例：`https://〇〇.vercel.app`。この住所をブラウザに入力すると、そのアプリが開く。 |
| **クラウド** | **インターネット上にある「預かり庫」**。ここにデータを保存しておくと、別のスマホやパソコンからも同じデータを見られる。 |
| **同期（どうき）** | あなたのスマホと、相手のスマホで**同じデータ**になるように、クラウドとやりとりすること。 |

**ゴール**  
→ アプリを「インターネットに置く」（デプロイ）  
→ **スマホでもPCでも**、同じ住所（URL）を開いて使う  
→ **クラウド同期**をONにすると、夫婦で同じ家計データを見たり書き換えたりできる（スマホ同士でも、PCとスマホでも同期されます）

---

## 準備：必要なもの

- パソコン（いま家計簿アプリを触っているもの）
- インターネットにつながっていること
- **GitHub（ギットハブ）**のアカウント（まだなら、下の「ステップ0」で作る）
- **Vercel（ヴァーセル）**のアカウント（ステップ1で作る）
- 妻さん・ご自身のスマホ（あとで開くとき用）

---

## ステップ0：GitHubのアカウントを作る（まだの人だけ）

GitHubは「プログラムの入れ物を、インターネット上に置いておく場所」です。  
Vercelが「あなたのアプリ」を取りに行くために、この入れ物が必要になります。

1. ブラウザで **https://github.com** を開く。
2. 右上の **「Sign up」** を押す。
3. メールアドレス、パスワード、ユーザー名を入れて、**「Create account」** を押す。
4. メールが届いたら、書いてあるとおりに「認証」する。
5. これで **GitHubのアカウント** ができた。

※ すでにアカウントがある人は、このステップはとばしてOK。

---

## ステップ1：家計簿アプリをGitHubに上げる

「あなたのパソコンにある家計簿アプリ」を、GitHubという場所に**コピーして置く**作業です。

### 1-1. フォルダをGitの「入れ物」にする

ここでは **「ターミナル」** という画面を使います。  
ターミナルは、**キーボードで文字を打ってパソコンに指示を出す**ための窓です。マウスでクリックするのではなく、**コマンド**（命令の文字）を打ち込んでEnterを押します。

---

**① ターミナルを開く**

- **Mac の場合**  
  -  Spotlight（画面右上の虫眼鏡）で「ターミナル」と入力 → **ターミナル** を選んで開く。  
  - または「アプリケーション」→「ユーティリティ」→「ターミナル」。
- **Windows の場合**  
  - スタートメニューで「cmd」と入力 → **コマンドプロンプト** を開く。

白い（または黒い）窓が開いて、何か文字が並んでいればOKです。

---

**② 「家計簿アプリのフォルダに移動する」とは？**

ターミナルは今、**どこか一つのフォルダを指しています**。  
「移動する」とは、**その指している場所を、家計簿アプリのフォルダに変える**ことです。  
そうしないと、このあと打つ `git init` が「どのフォルダに対して？」かわからなくなってしまいます。

- 家計簿アプリのフォルダが **書類（Documents）の中** にある場合（例：`書類/家計簿アプリ`）：  
  ターミナルに次のように**そのまま打ち込んで**、Enterを押す。
  ```bash
  cd Documents/家計簿アプリ
  ```
  ※ Macで「書類」が英語で「Documents」と表示されている場合の例です。実際のフォルダ名が「家計簿アプリ」なら、そのまま使って大丈夫です。
- フォルダが **デスクトップ** にある場合：  
  ```bash
  cd デスクトップ/家計簿アプリ
  ```
  ※ または英語なら `cd Desktop/家計簿アプリ`

**打ち方のコツ**：`cd` のあとに**スペースを1つ**入れてから、フォルダの場所を打つ。  
うまくいくと、次の行の先頭に、そのフォルダの名前（またはパス）が出ます。エラーと出た場合は、フォルダの名前や場所を一度確認してみてください。

- **Macで「パスがわからない」とき**：`cd ` まで打ったあと、**Finderで「家計簿アプリ」フォルダを、ターミナルの窓にドラッグ＆ドロップ**すると、フォルダの場所が自動で入ります。そのあとEnterを押せばOKです。

---

**③ Git の「入れ物」にする（git init）**

「このフォルダを、これからGitで管理します」とパソコンに伝える命令です。

1. ターミナルで、次の文字を打ってEnterを押す。
   ```bash
   git init
   ```
2. 「Initialized empty Git repository in …」のような英語が出れば成功です。  
   「このフォルダに、Gitの入れ物ができた」という意味なので、このステップはここまででOKです。

### 1-2. GitHubに「入れ物（リポジトリ）」を作る

1. ブラウザで **https://github.com** にログインする。
2. 右上の **「+」** を押して、**「New repository」** を選ぶ。
3. **Repository name** に、好きな名前を入れる。例：`kakeibo-app`。
4. **「Public」** のままにする。
5. **「Create repository」** を押す。
6. 画面に「…or push an existing repository from the command line」と出る。その下に、`git remote add origin https://github.com/あなたのユーザー名/kakeibo-app.git` のような文がある。**あなたのユーザー名とリポジトリ名**になっていることを確認する。

### 1-3. 家計簿アプリのファイルをGitHubに送る

1. ターミナル（またはコマンドプロンプト）に戻る。
2. 次のコマンドを**順番に**打つ（1行ずつEnter）。
   ```bash
   git add .
   git commit -m "はじめての保存"
   git branch -M main
   git remote add origin https://github.com/あなたのユーザー名/kakeibo-app.git
   git push -u origin main
   ```
   ※ `あなたのユーザー名` と `kakeibo-app` は、1-2で作ったリポジトリに合わせて変える。
3. GitHubのユーザー名とパスワード（またはトークン）を聞かれたら、入れる。
4. 終わったら、GitHubのサイトで **そのリポジトリ** を開くと、家計簿アプリのファイルが並んでいる。これで「GitHubに上げた」完了。

---

## ステップ2：Vercelで「インターネットに置く」（デプロイ）

Vercelは「あなたのアプリを、世界中の人が開けるURLにしてくれるサービス」です。  
**無料**で使えます。

### 2-1. Vercelのアカウントを作る

1. ブラウザで **https://vercel.com** を開く。
2. **「Sign Up」** を押す。
3. **「Continue with GitHub」** を選ぶ。
4. GitHubの画面が出たら、**「Authorize Vercel」** などと書いてあるボタンを押して、Vercelに「GitHubを見ていいよ」と許可する。
5. これでVercelにログインした状態になる。

### 2-2. 家計簿アプリの「入れ物」をVercelに教える

1. Vercelの画面で **「Add New…」** → **「Project」** を押す。
2. **「Import Git Repository」** のところに、GitHubのリポジトリの一覧が出る。
3. **「kakeibo-app」**（またはあなたがつけた名前）を選んで、**「Import」** を押す。
4. **Framework Preset** は **「Vite」** になっているか確認する（なっていなければ選ぶ）。
5. **「Deploy」** を押す。
6. 数十秒〜1分ほど待つ。画面に **「Congratulations」** や **「Your project has been deployed」** と出たら成功。
7. 画面に **「Visit」** というボタンが出る。それを押すと、**あなたの家計簿アプリが開く**。
8. そのときの**上のアドレス欄のURL**（例：`https://kakeibo-app-xxxx.vercel.app`）が、**あなたの家計簿の「住所」**です。このURLをメモするか、自分にメールで送っておく。

ここまでできたら、**「スマホからもこのURLを開けば、同じ家計簿アプリが使える」**状態になっています。

---

## ステップ3：スマホ・PCで開いてみる

### スマホで開く

1. **スマホ**で**ブラウザ**（SafariやChrome）を開く。
2. アドレスを入れるところ（URL欄）をタップして、**ステップ2でメモしたURL**を入力する。
3. Enter（または「開く」）を押す。
4. 家計簿アプリの画面が出ればOK。  
   - 出ないとき：URLを一文字ずつ確認する。`https://` から始まっているか、最後に余計なスペースが入っていないか見る。

### PCで開く

1. **パソコン**の**ブラウザ**（ChromeやEdgeなど）を開く。
2. アドレス欄に**同じURL**（ステップ2でメモしたもの）を入力してEnter。
3. 家計簿アプリの画面が出ればOK。スマホで入れたデータは、クラウド同期をONにしていれば、PCでも同じように見えます。

これで **「オンラインでスマホ・PCのどちらからも使える」** ができています。

---

## ステップ4：夫婦で同じデータを見る（クラウド同期）

「妻のスマホで入れたデータを、夫のスマホでも見たい」というときは、**クラウド同期**を使います。  
ここでは **Supabase（スーパベース）** という無料の「預かり庫」を使います。

### 4-1. Supabaseで「預かり庫」を用意する（少しだけ設定が必要）

1. ブラウザで **https://supabase.com** を開く。
2. **「Start your project」** から、GitHubでログインする。
3. **「New project」** で、名前（例：kakeibo）とパスワードを入れて、**「Create new project」** を押す。
4. 1〜2分待つ。プロジェクトができたら、左のメニューで **「SQL Editor」** を開く。
5. 次の **SQL** をコピーして、大きな入力欄に貼り付ける。そして **「Run」** を押す。
   ```sql
   create table if not exists household_sync (
     id text primary key,
     data jsonb not null,
     updated_at timestamptz not null
   );
   ```
   これで「預かり庫」のテーブルができる。
5-b. **同期が動くために重要**：同じ **SQL Editor** で、次の **SQL も** コピーして貼り付け、**「Run」** を押す。
   ```sql
   alter table household_sync enable row level security;

   create policy "Allow anon to read household_sync"
     on household_sync for select to anon using (true);

   create policy "Allow anon to insert household_sync"
     on household_sync for insert to anon with check (true);

   create policy "Allow anon to update household_sync"
     on household_sync for update to anon using (true);
   ```
   これで、家計簿アプリ（anon キー）から「読む・保存する・上書きする」ができるようになる。**これをやらないとスマホとPCで同期されません。**  
   （「ポリシーはすでに存在します」と出たら、その部分は飛ばしてOKです。）
6. 左の **「Project Settings」**（歯車マーク）を開く。
7. **「Project URL」** と **「anon public」のキー** をメモする。
   - **「Project URL」**：左メニューの **「Data API」** をクリックすると、画面に **「Project URL」** の欄が出ます。コピーしてメモする。
   - **「anon public」のキー**：左メニューで **「Data API」の下にある「API Keys」** をクリックする。開いたページに **「anon」** と **「service_role」** の2つのキーが並んでいます。**「anon」** と書いてあるほうの長い英数字が「anon public」のキーです。右のコピーマークでコピーし、メモする。**「service_role」** は使わないでください。
8. **「世帯ID」** は、夫婦で同じものにしたいので、自分で決める。例：`my-house-001`。これもメモする。

※ ステップ4が難しければ、いったん「ステップ3まで」でやめておいても大丈夫です。その場合でも、**それぞれのスマホで同じURLを開けば、それぞれのスマホの中にデータが保存されます**。ただし「夫婦で同じデータを共有する」だけは、ステップ4をやってからになります。

### 4-2. 家計簿アプリの「設定」で同期をONにする

**「クラウド同期」がどこか**  
→ 家計簿アプリを開いて、**下のナビ（または左サイドバー）の「設定」** をタップ／クリックする。  
→ 設定画面の**いちばん上**に出ている、**「クラウド同期設定」** と書いてある**青っぽい見出しの下**が、クラウド同期のブロックです。ここに **Supabase URL**・**API Key（anon のキー）**・**世帯ID** の3つの入力欄**と、「同期を有効にする」のスイッチ**があります。

1. スマホまたはパソコンで、**あなたの家計簿アプリのURL**（VercelのURL）を開く。
2. 画面の **「設定」** タブを開く。
3. **いちばん上の「クラウド同期設定」のブロック**で、
   - **Supabase URL** の欄に、4-1でメモした **Project URL** を入れる。
   - **API Key（anon のキー）** の欄に、**anon** のキーを入れる。
   - **世帯ID** の欄に、**夫婦で同じもの**（例：`my-house-001`）を入れる。
4. 同じブロック内の **「同期を有効にする」** のスイッチを **ON**（右側に寄せる）にする。
5. **妻のスマホ**・**夫のスマホ**・**使うPC**のすべてで、**同じURLを開いて、同じ3つの値（Supabase URL・API Key・世帯ID）を入れて、同期をON**にする。

こうすると、どれか1台でデータを変えると、他のスマホやPCでも同じデータが見られるようになります（少し遅れて反映される場合もあります）。

---

## わからなくなったとき

- **「デプロイ」って何？**  
  → あなたのアプリを「インターネットに置く」こと。置くと、URLという住所で誰でも開けるようになる。

- **「URLを開く」って？**  
  → スマホやパソコンのブラウザの「アドレス欄」に、そのURLを打ち込んで、Enterを押すこと。

- **「クラウド同期」がどこかわからない**  
  → 家計簿アプリで **設定** タブを開く。**いちばん上**の「クラウド同期設定」という見出しの下がそれです。Supabase URL・API Key・世帯ID の3つの入力欄と、「同期を有効にする」のスイッチがあります。

- **「anon public」のキーがどこかわからない**  
  → Supabase の **Project Settings**（歯車）→ 左メニューの **「API Keys」**（Data API の下）を開く。**「anon」** と書いてあるほうの長い英数字がそれです。**「service_role」** は使わない。

- **スマホとPCで入力したけど内容が同期されない**  
  → まず **Supabase の SQL Editor** で、手順 4-1 の **5-b**（RLS のポリシーを追加する SQL）を実行したか確認する。まだなら実行する。  
  → そのうえで、スマホ・PCの**両方**で **Supabase URL・API Key・世帯ID** が**完全に同じ**か確認する（前後のスペースや改行が入っていないか）。  
  → **PCで入れたものをスマホに反映したいとき**：スマホで家計簿アプリの**タブを一度開いた状態で**、別アプリや別タブに移り、**もう一度家計簿のタブに戻る**と、自動でクラウドから取得して反映されます。アプリを完全に閉じてからURLを開き直しても反映されます。

- **妻と夫でデータが違う**  
  → 二人とも「設定」で、**同じ Supabase URL・同じ API Key・同じ 世帯ID** になっているか確認する。同期がONかも見る。

- **スマホで開けない**  
  → URLをコピー＆ペーストで入れると間違いが少ない。パソコンでそのURLを開いて、メールやLINEで自分に送り、スマホでそのリンクをタップして開く。

- **Git や コマンド が難しすぎる**  
  → ステップ1は、プログラミングに詳しい人に「この家計簿アプリのフォルダをGitHubに上げて」とお願いしてもOK。ステップ2以降は、ブラウザの操作だけなので、案内どおりにクリックしていけば進められる。

---

## やることの一覧（まとめ）

| 番号 | やること | できたら |
|------|----------|----------|
| 0 | GitHubのアカウントを作る | ログインできる |
| 1 | 家計簿アプリをGitHubに上げる | GitHubのサイトにファイルが並ぶ |
| 2 | Vercelでデプロイする | URLがもらえる・そのURLでアプリが開く |
| 3 | スマホ・PCでそのURLを開く | スマホでもPCでも家計簿が使える |
| 4 | Supabaseと設定で同期をONにする | 夫婦で同じデータが見られる（PCとも同期） |
| （あとでOK） | 設定で「Gemini APIキー」を保存する | AI診断・FP診断が使える |

**ひとつずつ、できたところにチェックをつけながら進めると、どこでつまずいたかわかりやすいです。**

---

## 用語メモ（中学生向け）

| ことば | 意味 |
|--------|------|
| **デプロイ** | 自分のパソコンにあるアプリを、インターネット上に置くこと。置くと、URLでどこからでも開ける。 |
| **URL** | インターネット上の住所。ブラウザのアドレス欄に入れるあれ。 |
| **クラウド** | インターネット上にある「預かり庫」。ここに保存すると、別の端末からも同じデータが見られる。 |
| **同期** | クラウドとやりとりして、どの端末で開いても同じデータになるようにすること。 |
| **APIキー** | 外部のサービス（ここではGoogleのAI）を使うときの「合言葉」。設定タブで1回入れておくと、AI診断が動く。 |
